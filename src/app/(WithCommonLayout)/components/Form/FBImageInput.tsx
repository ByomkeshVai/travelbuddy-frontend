import { useState } from "react";
import { Form, Upload } from "antd";
import { Controller } from "react-hook-form";

type TInputProps = {
  name: string;
  label?: string;
};

const FBImageInput = ({ name, label }: TInputProps) => {
  const [uploadedImage, setUploadedImage] = useState<string | null>(null);

  const handleUpload = (file: File) => {
    const reader = new FileReader();
    reader.readAsDataURL(file);
    reader.onload = () => {
      setUploadedImage(reader.result as string);
    };
  };

  return (
    <div style={{ marginBottom: "5px", width: "full" }}>
      <Controller
        name={name}
        render={({ field, fieldState: { error } }) => (
          <Form.Item label={label}>
            <Upload.Dragger {...field} id={name} beforeUpload={handleUpload}>
              <div className=" flex justify-center items-center h-[100px] p-[10px] border-dashed border-blue-100 ">
                {uploadedImage ? (
                  <img
                    src={uploadedImage}
                    alt="Uploaded"
                    className="w-full h-full"
                  />
                ) : (
                  <div className="flex flex-col justify-center items-center">
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="24"
                      height="25"
                      viewBox="0 0 24 25"
                      fill="none"
                    >
                      <path
                        d="M19.6006 7.58031C19.4066 7.58031 19.2412 7.5118 19.1043 7.37478C18.9675 7.23776 18.8991 7.0723 18.8991 6.87838V5.60048H17.6212C17.4272 5.60048 17.2618 5.53195 17.1248 5.39488C16.9877 5.2578 16.9192 5.09305 16.9192 4.90065C16.9192 4.70825 16.9877 4.54363 17.1248 4.40678C17.2618 4.26991 17.4272 4.20148 17.6212 4.20148H18.8991V2.91878C18.8991 2.72856 18.9676 2.56482 19.1047 2.42755C19.2417 2.2903 19.4065 2.22168 19.5989 2.22168C19.7913 2.22168 19.9559 2.2903 20.0928 2.42755C20.2296 2.56482 20.2981 2.72856 20.2981 2.91878V4.20148H21.5808C21.771 4.20148 21.9347 4.27015 22.072 4.40748C22.2092 4.5448 22.2779 4.70861 22.2779 4.89893C22.2779 5.09293 22.2092 5.25836 22.072 5.39521C21.9347 5.53206 21.771 5.60048 21.5808 5.60048H20.2981V6.87838C20.2981 7.0723 20.2294 7.23776 20.0921 7.37478C19.9547 7.5118 19.7909 7.58031 19.6006 7.58031ZM11 17.5139C12.1256 17.5139 13.0782 17.1251 13.8577 16.3473C14.6372 15.5696 15.0269 14.6161 15.0269 13.487C15.0269 12.3646 14.6372 11.4136 13.8577 10.6342C13.0782 9.85467 12.1256 9.46493 11 9.46493C9.87438 9.46493 8.92262 9.85467 8.14474 10.6342C7.36686 11.4136 6.97792 12.3646 6.97792 13.487C6.97792 14.6161 7.36686 15.5696 8.14474 16.3473C8.92262 17.1251 9.87438 17.5139 11 17.5139ZM10.9963 16.1149C10.2539 16.1149 9.63171 15.8628 9.12979 15.3587C8.62789 14.8545 8.37694 14.2323 8.37694 13.4921C8.37694 12.7519 8.62799 12.1289 9.13009 11.6229C9.63219 11.1169 10.2546 10.864 10.9973 10.864C11.74 10.864 12.3641 11.1169 12.8696 11.6229C13.3752 12.1289 13.6279 12.7519 13.6279 13.4921C13.6279 14.2323 13.3749 14.8545 12.869 15.3587C12.363 15.8628 11.7388 16.1149 10.9963 16.1149ZM3.40659 20.7976C2.93404 20.7976 2.5318 20.6316 2.19987 20.2997C1.86793 19.9677 1.70197 19.5652 1.70197 19.0922V7.89438C1.70197 7.42131 1.86793 7.01881 2.19987 6.68688C2.5318 6.35495 2.93474 6.18898 3.40869 6.18898H6.46254L7.76254 4.76398C7.91862 4.58918 8.10743 4.45173 8.32897 4.35163C8.5505 4.25153 8.78508 4.20148 9.03272 4.20148H14.1308C14.321 4.20148 14.4847 4.2703 14.622 4.40793C14.7593 4.54555 14.8279 4.70974 14.8279 4.90051V6.4106C14.8279 6.7665 14.9531 7.06902 15.2034 7.31815C15.4537 7.56729 15.7577 7.69185 16.1154 7.69185H16.8077V8.38418C16.8077 8.74181 16.9322 9.0458 17.1813 9.29615C17.4304 9.54649 17.7328 9.67166 18.0887 9.67166H19.6004C19.7915 9.67166 19.9555 9.74029 20.0925 9.87755C20.2296 10.0148 20.2981 10.1785 20.2981 10.3688V19.0909C20.2981 19.5648 20.1321 19.9677 19.8002 20.2997C19.4682 20.6316 19.066 20.7976 18.5934 20.7976H3.40659Z"
                        fill="#2D65F2"
                      />
                    </svg>
                    <p className="text-blue-400 text-[16px] font-semibold">
                      Add or Drag file
                    </p>
                    <p className="text-black-light">
                      JPEG, PNG. Max size limit 3 MB
                    </p>
                  </div>
                )}
              </div>
            </Upload.Dragger>
            {error && <small style={{ color: "red" }}>{error.message}</small>}
          </Form.Item>
        )}
      />
    </div>
  );
};

export default FBImageInput;
